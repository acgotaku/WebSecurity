# Browser Sandbox

浏览器沙箱

---

##基本介绍

沙盒是一种安全机制，为运行中的程序提供的隔离环境。通常是作为一些来源不可信、具破坏力或无法判定程序意图的程序提供实验之用。而对于浏览器来说，采用 Sandbox 技术，无疑可以让不受信任的网页代码、JavaScript代码运行在一个受到限制的环境中，从而保护本地桌面系统的安全。

##多进程架构

近几年来，网站被挂马呈爆发趋势。“挂马”是浏览器需要面对的一个主要威胁。独立于杀毒软件之外，浏览器厂商根据挂马的特点研究出了一些对抗挂马的技术。

比如在Windows系统中，浏览器密切结合DEP、ASLR、SafeSEH等操作系统提供的保护技术，对抗内存攻击。与此同时，浏览器还发展出了多进程架构，从安全性上有了很大的提高。

浏览器的多进程架构，将浏览器的各个功能模块分开，各个浏览器实例分开，当一个进程崩溃时，也不会影响到其他的进程。

Google Chrome 是第一个采取多进程架构的浏览器。Google Chrome的主要进程分为：浏览器进程、渲染进程、插件进程、扩展进程。插件进程如 flash、java、pdf等与浏览器进程严格隔离，因此不会相互影响。

多进程架构最明显的一个好处是，相对于单进程浏览器，在发生崩溃时，多进程浏览器只会崩溃当前的 Tab 页，而单进程浏览器则会崩溃整个浏览器进程。这对于用户体验是很大的提升。

##Sandbox

Sandbox 即沙箱，计算机技术发展到今天，Sandbox已经成为泛指 “资源隔离类模块” 的代名词。Sandbox的设计目的一般是为了不让不可信任的代码运行在一定的环境中，
限制不可信任的代码访问隔离区之外的资源。如果一定要跨越 Sandbox边界产生数据交换，则只能通过指定的数据通道，比如经过封装的API来完成，在这些API中会严格检查请求的合法性。

Sandbox的应用范围非常广泛。比如一个提供 hosting 服务的共享主机环境，假设支持用户上传PHP、Python、Java等语言的代码，为了防止用户代码破坏系统环境，或者是不同用户之间的代码相互影响，则应该设计一个 Sandbox 对用户代码进行隔离。Sandbox 需要考虑用户代码针对本地文件系统、内存、数据库、网络的可能请求，可以采用默认拒绝的策略，对于有需要的请求，则可以通过封装API的方式实现。

Google Chrome 实现了一个相对完整的 Sandbox：

![Google Sandbox](img/Sandbox-1.png)

浏览器安全是一个整体，在现今的浏览器中，虽然有很多进程架构和 Sandbox的保护，但是浏览器所加载的一些第三方插件却往往不受 Sandbox 管辖。近年来的浏览器漏洞往往都是由于加载的第三方插件出现安全漏洞导致的。